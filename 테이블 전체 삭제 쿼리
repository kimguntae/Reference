테이블이 여러개 있다면 하나하나 삭제하기 불편합니다.

이런경우 SYSTEM 테이블과 CURSOR 를 사용하여 삭제를 하는 방법이 있습니다.

 

먼저 삭제하고자 하는 테이블이 있는 데이터베이스로 이동하셔서

 

SELECT * FROM SYSOBJECTS

 

를 실행해 보시면 어려가지 데이터베이스 개체들이 나오는데

사용자가 생성한 테이블을 보는 방법은 다음과 같습니다

 

SELECT *  FROM SYSOBJECTS WHERE XTYPE='U'

 

이 사용자가 생성한 테이블을 삭제하고자 하면 CURSOR를 사용합니다.

(커서를 사용하는 방법은 온라인 설명서를 참고바랍니다.)

 

DECLARE @TABLENAME SYSNAME

DECLARE @SQL NVARCHAR(100)


 

DECLARE U_CURSOR CURSOR FOR

       SELECT NAME FROM SYSOBJECTS WHERE XTYPE='U' 

OPEN U_CURSOR

 

FETCH NEXT FROM U_CURSOR 

INTO @TABLENAME

 

WHILE @@FETCH_STATUS = 0

BEGIN

 

       SET @SQL = 'DELETE FROM ' + @TABLENAME

       EXEC (@SQL)

      

    FETCH NEXT FROM U_CURSOR 

    INTO @TABLENAME

END

CLOSE U_CURSOR

DEALLOCATE U_CURSOR
